<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TechnoDemocracy – Early Manifesto</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Hide from search engines for now -->
  <meta name="robots" content="noindex, nofollow, noarchive" />
  <meta name="googlebot" content="noindex, nofollow" />
  <!-- Helps if anything ever accidentally uses http:// -->
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

  <style>
    :root {
      --bg1: #050816;
      --bg2: #120c2f;
      --accent: #9b5cff;
      --accent-soft: rgba(155, 92, 255, 0.3);
      --text-main: #f9f9ff;
      --text-muted: #c0c2ff;
      --card-bg: rgba(8, 10, 35, 0.9);
      --border-subtle: rgba(255, 255, 255, 0.08);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, var(--bg2), var(--bg1) 55%);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .shell {
      max-width: 880px;
      width: 100%;
      background: radial-gradient(circle at top left, var(--accent-soft), transparent 55%),
                  linear-gradient(135deg, rgba(10, 12, 40, 0.98), rgba(5, 6, 25, 0.98));
      border-radius: 32px;
      padding: 28px 24px 32px;
      border: 1px solid var(--border-subtle);
      box-shadow:
        0 18px 50px rgba(0, 0, 0, 0.55),
        0 0 0 1px rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(20px);
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 20px;
    }

    .title-group h1 {
      font-size: clamp(1.8rem, 2.4vw + 1rem, 2.6rem);
      letter-spacing: 0.03em;
    }

    .title-group p {
      margin-top: 4px;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .badge {
      border-radius: 999px;
      border: 1px solid var(--accent-soft);
      padding: 6px 12px;
      font-size: 0.8rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: rgba(6, 8, 30, 0.9);
      color: var(--text-muted);
      white-space: nowrap;
    }

    .dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 12px var(--accent);
    }

    .top-row {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      align-items: stretch;
      margin-bottom: 18px;
    }

    .counter-card {
      flex: 1 1 230px;
      background: rgba(4, 7, 30, 0.95);
      border-radius: 24px;
      padding: 16px 18px;
      border: 1px solid var(--border-subtle);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      gap: 6px;
    }

    .counter-label {
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
    }

    .counter-number {
      font-variant-numeric: tabular-nums;
      font-size: 2.2rem;
      font-weight: 600;
      letter-spacing: 0.04em;
    }

    .counter-caption {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .manifesto-card {
      flex: 2 1 300px;
      background: var(--card-bg);
      border-radius: 24px;
      border: 1px solid var(--border-subtle);
      padding: 16px 18px;
      overflow: hidden;
    }

    .manifesto-card h2 {
      font-size: 0.95rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 10px;
    }

    .manifesto-lead {
      font-size: 0.95rem;
      line-height: 1.6;
      color: var(--text-main);
    }

    .manifesto-lead strong { color: var(--accent); }

    main {
      margin-top: 10px;
      background: rgba(3, 5, 24, 0.95);
      border-radius: 24px;
      border: 1px solid var(--border-subtle);
      padding: 18px 20px;
      max-height: 380px;
      overflow-y: auto;
      scrollbar-width: thin;
      scrollbar-color: var(--accent-soft) transparent;
    }

    main::-webkit-scrollbar { width: 6px; }
    main::-webkit-scrollbar-track { background: transparent; }
    main::-webkit-scrollbar-thumb {
      background-color: var(--accent-soft);
      border-radius: 999px;
    }

    main h3 {
      font-size: 0.9rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    main p {
      font-size: 0.95rem;
      line-height: 1.7;
      color: var(--text-main);
      margin-bottom: 12px;
    }

    main p:last-child { margin-bottom: 0; }

    .footer-note {
      margin-top: 10px;
      font-size: 0.75rem;
      color: var(--text-muted);
      opacity: 0.9;
    }

    @media (max-width: 640px) {
      .shell { padding: 20px 16px 22px; border-radius: 24px; }
      header { flex-direction: column; align-items: flex-start; }
      .badge { align-self: flex-start; }
      .counter-number { font-size: 1.9rem; }
      main { max-height: none; }
    }
  </style>
</head>

<body>
  <div class="shell">
    <header>
      <div class="title-group">
        <h1>TechnoDemocracy</h1>
        <p>A humble manifesto for a kinder, smarter, more participatory future.</p>
      </div>
      <div class="badge">
        <span class="dot"></span>
        Early universe · v0.1
      </div>
    </header>

    <div class="top-row">
      <section class="counter-card" aria-label="Human counter">
        <div>
          <div class="counter-label">Humans who opened this page</div>
          <div class="counter-number" id="human-counter">…</div>
        </div>
        <p class="counter-caption">
          This is an experimental, approximate counter.
          In later versions it will become part of a transparent, auditable “human aura” system.
        </p>
      </section>

      <section class="manifesto-card">
        <h2>Manifesto · Snapshot</h2>
        <p class="manifesto-lead">
          <strong>TechnoDemocracy</strong> (working title DDemocracy) is an experiment in
          rebalancing power: combining people, expertise and technology so that
          big decisions are made <em>with</em> citizens instead of merely <em>for</em> them.
          This page is the first public seed of that idea.
        </p>
      </section>
    </div>

    <main aria-label="Manifesto text">
      <h3>Manifesto (preview)</h3>

      <p>
        This is a placeholder for the full manifesto text. For now, TechnoDemocracy
        lives as a simple promise: that large-scale decisions can be made more
        intelligently, more compassionately, and with far greater participation
        than today’s systems allow.
      </p>

      <p>
        The long-term vision combines:
        citizens chosen by sortition,
        transparent data,
        expert panels,
        and AI systems that are tightly aligned to human values,
        not corporate or party interests.
      </p>

      <p>
        In future iterations, this page will link to:
        the full manifesto, the governance blueprint, and an open library
        of questions, critiques and alternative proposals.
        For now, it is simply a small light on the map saying:
        “There are better ways to organise ourselves.”
      </p>

      <p>
        If you are reading this, you are part of the very first wave of humans
        to encounter the idea. Thank you for being here at the beginning.
      </p>
    </main>

    <p class="footer-note">
      v0.1 · Static prototype. Counter uses a simple external service and is not yet an official,
      auditable tally. Future versions will be open source and verifiable.
    </p>
  </div>

  <script>
    (() => {
      const el = document.getElementById("human-counter");
      if (!el) return;

      // CountAPI config
      const NAMESPACE = "technodemocracy.world";
      const KEY = "visits"; // change to "visits-v2" if you want a fresh reset
      const BASE = "https://api.countapi.xyz";

      // “Humans” approximation: count max once per 12h per browser.
      const HIT_COOLDOWN_MS = 12 * 60 * 60 * 1000;

      // Bump storage keys to avoid older cached values (like 0) poisoning display.
      const LS_LAST_HIT = "td_counter_last_hit_v2";
      const LS_LAST_VALUE = "td_counter_last_value_v2";

      const ls = {
        get(k) { try { return localStorage.getItem(k); } catch { return null; } },
        set(k, v) { try { localStorage.setItem(k, v); } catch {} },
        del(k) { try { localStorage.removeItem(k); } catch {} }
      };

      const format = (n) => {
        try { return new Intl.NumberFormat("en-GB").format(n); }
        catch { return String(n); }
      };

      const setDisplay = (text, title) => {
        el.textContent = text;
        if (title) el.title = title;
      };

      const ns = encodeURIComponent(NAMESPACE);
      const key = encodeURIComponent(KEY);
      const hitUrl = `${BASE}/hit/${ns}/${key}`;
      const getUrl = `${BASE}/get/${ns}/${key}`;

      // If we have a meaningful cache, show it immediately.
      const cached = Number(ls.get(LS_LAST_VALUE));
      if (Number.isFinite(cached) && cached > 0) {
        setDisplay(format(cached));
      } else {
        setDisplay("loading…");
      }

      const now = Date.now();
      const lastHit = Number(ls.get(LS_LAST_HIT));
      const lastHitValid = Number.isFinite(lastHit) && lastHit > 0 && lastHit <= now;
      const shouldHit = !lastHitValid || (now - lastHit) > HIT_COOLDOWN_MS;

      const fetchJson = async (url, timeoutMs = 7000) => {
        const controller = new AbortController();
        const t = setTimeout(() => controller.abort(), timeoutMs);
        try {
          const res = await fetch(url, { signal: controller.signal, cache: "no-store" });
          const data = await res.json().catch(() => null);

          if (!res.ok) {
            const err = new Error("HTTP " + res.status);
            err.status = res.status;
            throw err;
          }

          // Guard against weird payloads
          if (!data || typeof data.value === "undefined") {
            const err = new Error("Bad payload");
            err.status = 500;
            throw err;
          }

          return data;
        } finally {
          clearTimeout(t);
        }
      };

      const commitValue = (value) => {
        setDisplay(format(value));
        if (value > 0) ls.set(LS_LAST_VALUE, String(value));
      };

      const showBlockedOrOffline = () => {
        // Don't lie with "0" — show "—" if it can't fetch.
        setDisplay("—", "Counter unavailable (blocked/offline).");
      };

      (async () => {
        try {
          let data;

          if (shouldHit) {
            data = await fetchJson(hitUrl);
            ls.set(LS_LAST_HIT, String(now));
          } else {
            // cooldown: try get, but if it fails, seed with a hit
            try {
              data = await fetchJson(getUrl);
            } catch {
              data = await fetchJson(hitUrl);
              ls.set(LS_LAST_HIT, String(now));
            }
          }

          let value = Number(data.value);

          // If service returns 0 (common when counter isn't really seeded), seed once.
          if (!Number.isFinite(value) || value === 0) {
            const seeded = await fetchJson(hitUrl);
            value = Number(seeded.value);
            ls.set(LS_LAST_HIT, String(now));
          }

          if (!Number.isFinite(value)) throw new Error("Bad value");
          commitValue(value);
        } catch (e) {
          console.warn("Human counter failed:", e);
          const fallback = Number(ls.get(LS_LAST_VALUE));
          if (Number.isFinite(fallback) && fallback > 0) commitValue(fallback);
          else showBlockedOrOffline();
        }
      })();
    })();
  </script>
</body>
</html>
